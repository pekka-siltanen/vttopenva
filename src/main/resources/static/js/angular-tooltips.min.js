//The MIT License (MIT)

//Copyright (c) 2016 Intellipharm

//Permission is hereby granted, free of charge, to any person obtaining a copy
//of this software and associated documentation files (the "Software"), to deal
//in the Software without restriction, including without limitation the rights
//to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
//copies of the Software, and to permit persons to whom the Software is
//furnished to do so, subject to the following conditions:

//The above copyright notice and this permission notice shall be included in all
//copies or substantial portions of the Software.

//THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
//SOFTWARE.
!function(){"use strict";var t=function(t,o){return{restrict:"A",scope:{title:"@",fixedPosition:"=",titleClass:"@"},link:function(e,i,n){e.createTooltip=function(t){if(n.title||n.tooltip){e.getDirection();e.tooltipElement=angular.element("<div>").addClass("angular-tooltip").addClass(e.titleClass),angular.element(document).find("body").append(e.tooltipElement),e.updateTooltip(n.title||n.tooltip),e.tooltipElement.addClass("angular-tooltip-fade-in")}},e.updateTooltip=function(n){e.tooltipElement.html(n),o(e.tooltipElement.contents())(e);var l=e.calculatePosition(e.tooltipElement,e.getDirection());e.tooltipElement.addClass("angular-tooltip-"+l.direction).css(l),t(function(){i.removeAttr("ng-attr-title"),i.removeAttr("title")})},e.$watch("title",function(t){e.tooltipElement&&e.updateTooltip(t)}),e.removeTooltip=function(){angular.element(document.querySelectorAll(".angular-tooltip")).remove()},e.getDirection=function(){return i.attr("tooltip-direction")||i.attr("title-direction")||"top"},e.calculatePosition=function(t,o){var n=t[0].getBoundingClientRect(),l=i[0].getBoundingClientRect(),r=window.scrollX||document.documentElement.scrollLeft,a=window.scrollY||document.documentElement.scrollTop,p={},s=null;return e.stringStartsWith(o,"left")?p.left=l.left-n.width-6+r:e.stringStartsWith(o,"right")?p.left=l.left+l.width+6+r:e.stringContains(o,"left")?p.left=l.left-n.width+12+r:e.stringContains(o,"right")?p.left=l.left+l.width-12+r:p.left=l.left+l.width/2-n.width/2+r,e.stringStartsWith(o,"top")?p.top=l.top-n.height-6+a:e.stringStartsWith(o,"bottom")?p.top=l.top+l.height+6+a:e.stringContains(o,"top")?p.top=l.top-n.height+12+a:e.stringContains(o,"bottom")?p.top=l.top+l.height-12+a:p.top=l.top+l.height/2-n.height/2+a,e.fixedPosition&&(p.left<r?s=o.replace("left","right"):p.left+n.width>window.innerWidth+r&&(s=o.replace("right","left")),p.top<a?s=o.replace("top","bottom"):p.top+n.height>window.innerHeight+a&&(s=o.replace("bottom","top")),s)?e.calculatePosition(t,s):(p.left+="px",p.top+="px",p.direction=o,p)},e.stringStartsWith=function(t,o){return t.substr(0,o.length)===o},e.stringContains=function(t,o){return-1!==t.indexOf(o)},n.title||n.tooltip?(i.on("mouseover",e.createTooltip),i.on("mouseout",e.removeTooltip)):(i.off("mouseover",e.createTooltip),i.off("mouseout",e.removeTooltip)),i.on("destroy",e.removeTooltip),e.$on("$destroy",e.removeTooltip)}}};t.$inject=["$timeout","$compile"],angular.module("tooltips",[]).directive("title",t).directive("tooltip",t)}();